<!DOCTYPE html>
<html>
<title>Vincent Hendriks' Portfolio</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../css/styles.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Raleway", sans-serif}
</style>
<body class="w3-light-grey w3-content" style="max-width:1600px">

<!-- Sidebar/menu -->
<nav class="w3-sidebar w3-collapse w3-white" style="z-index:3;width:300px;" id="mySidebar"><br>
  <div class="w3-container">
    <a href="#" onclick="w3_close()" class="w3-hide-large w3-right w3-jumbo w3-padding w3-hover-grey" title="close menu">
      <i class="fa fa-remove"></i>
    </a>
    <img src="../images/avatar.png" style="width:45%;" class="w3-round"><br><br>
    <h4><b>PORTFOLIO</b></h4>
    <p class="w3-text-grey">Software Engineering student</p>
  </div>
  <div class="w3-bar-block">
    <a href="../index.html" onclick="w3_close()" class="w3-bar-item w3-button w3-padding "><i class="fa fa-th-large fa-fw w3-margin-right"></i>PORTFOLIO</a> 
	<a href="../index.html#about" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-user fa-fw w3-margin-right"></i>ABOUT</a> 
	<a href="../index.html#blog" onclick="w3_close()" class="w3-bar-item w3-button w3-padding w3-text-teal"><i class="fa fa-th-large fa-fw w3-margin-right"></i>BLOG</a> 
    <a href="../index.html#contact" onclick="w3_close()" class="w3-bar-item w3-button w3-padding"><i class="fa fa-envelope fa-fw w3-margin-right"></i>CONTACT</a>
  </div>
  <div class="w3-panel w3-large">
   <a href="https://www.linkedin.com/in/vincent-hendriks-aa627a146/" target="_blank"><i class="fa fa-linkedin w3-hover-opacity iconmargin"></i></a>
   <a href="https://github.com/Emperor2000/" target="_blank"><i class="fa fa-github w3-hover-opacity iconmargin"></i></a>

  </div>
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px">

  <!-- Header -->
  <header id="portfolio">
    <a href="#"><img src="images/avatar.png" style="width:65px;" class="w3-circle w3-right w3-margin w3-hide-large w3-hover-opacity"></a>
    <span class="w3-button w3-hide-large w3-xxlarge w3-hover-text-grey" onclick="w3_open()"><i class="fa fa-bars"></i></span>
    <div class="w3-container">
    <h1><b>Blog Posts</b></h1>
    <div class="w3-section w3-bottombar w3-padding-16">
	<!--
      <span class="w3-margin-right">Filter:</span> 
      <button class="w3-button w3-black">ALL</button>
      <button class="w3-button w3-white"><i class="fa fa-diamond w3-margin-right"></i>Design</button>
      <button class="w3-button w3-white w3-hide-small"><i class="fa fa-photo w3-margin-right"></i>Photos</button>
      <button class="w3-button w3-white w3-hide-small"><i class="fa fa-map-pin w3-margin-right"></i>Art</button>
	  -->
    </div>
    </div>
  </header>
  
    <div class="w3-container w3-padding-large" style="margin-bottom:32px">
    <h3><b>Creating a space arcade game in "Game Maker Studio 2" | Part 1"</b></h3>
	<p>As someone who studies Software Engineering my main area of expertise is application development, when I have the time for it I also like to delve into the world of game development. This blog post covers some things I learned during the development of creating a space combat game.</p>
	<p>	In this blog you can read about the design principles I followed, how I tackled problems along the way and how I created some of the core mechanics for the game.</p>
	<hr>
	<h4>Features</h4>
	<p>This game is not very realistic. Instead it is more of a step towards an arcade game. A couple of features have been implemented that make the game a bit more chaotic. The player's spaceship slows down fairly quickly, the player can change direction anywhere in his flight, the player can take down enemy ships and there are allied ships that fight alongside the player, to name a few.</p>
	<p>During the development that took place over a timespan of multiple months (Usually I worked on the project a few hours a week) I added a lot of new features. In order to do this effectively I learned a lot about how to go about setting up a project like this, what to keep in mind and how to prevent having to rewrite major chunks of code.
	<hr>
	<img class="img-fluid" width="50%" src="../images/spaceanim.gif" alt="Hyperspace" />
	<h4>Setting up the project</h4>
	<p>I learned the hard way that you should give at least some thought to how you are going to setup your project, even if it is pretty small you might decide later on that you want to expand it. if you do not plan or use design principles the odds are pretty big that you will have to rewrite parts of your code later on, by which point you probably won't remember what any of it does. Sounds familiar? Here are a few tips:</p>
	<p><ul>
	<li>Don't use magic numbers. Code can get quite confusing when you don't remember what those silly numbers do, assign your numbers to a variable first, give it a clear name so you still know what the value means a week, a month or a year from now, (hopefully) you will be able to thank your past self!</li>
	<li>It is almost always a good idea to create a base class for an enemy, you can make all other types of enemies children of the base class. A lot of mechanics can be created with the base class without having to bother with each enemy object individually. Imagine having to change combat behaviour in every enemy because you decided that they should not be flying directly towards the player after all! You can avoid a lot of code duplication and it makes your code a lot easier to expand!</li>
	<img class="img-fluid" width="100%" src="../images/uml_diagram1_gfwblog.png" alt="Enemy types extend a base class" />
	<li>It's not a good idea to rush through features just for the sake of finishing them. The chances that you are going to edit mechanics are virtually always present. If the code was badly written to begin with, chances are you have to rewrite it due to bugs, performance, new features, etc. </li>
	</ul></p>
	<hr>
	<h4>The player</h4>
	<p>The player has a spaceship that has it's own unique mechanics. As we saw in the previous image the player also utilizes the "blue_fighter" class because, like the other blue ships the player is a type of blue ship. Some examples as to why this is useful will be discussed in a moment; however, lets first take a look at the player!</p>
	<p>The player has a bunch of variables, some important ones are summed up below:</p>
	<p>Instance variables: These variables can be accessed through any script in the player object and exist for as long as the object that contains them:</p>
	<ul> 
	<li>armor (health): A number that indicates the player's health (in this case a whole number/integer).</li>
	<li>return_room: A boolean that indicates whether the player should leave the "room" and return to the menu.</li>
	<li>alarm_triggered: A boolean that checks whether an "alarm" (timer) has been triggered.</li>
	<li>hyperspeed: Determines whether the player is in "hyperspeed"</li>
	<li>decal_count: A counter that checks how many active instances of decals/particles there are, to make sure it does not eat up performance.</li>
	</ul>
	<img class="img-fluid" width="50%" src="../images/variables.png" alt="An image of some instance variables." />
	<p>An image of some instance variables.
	<p>Local variables: These variables reset every time the script is executed, for example, a variable can reset to a default value every frame.</p>
	<ul>
	<li>_mouse_direction: Returns an angle in degrees using the point_direction(x1,y1,x2,y2) function which returns the direction of a vector in relation to the fixed x/y coordinates of the room.</li>
	<li>_thrust: Checks if the right mouse button is pressed.</li>
	<li>_angle_difference: The difference between the angle of the image and the direction in which the player aims the mouse.</li>
	<li>_offset: An amount anywhere between -4 and 4 to create a random offset for the engine particle (not an integer).</li>
	<li>_length: 16, exactly half the width of the image of the player's ship to draw the engine particle at the correct location.</li>
	<li>_x: The x position at which an engine particle effect is drawn.</li>
	<li>_y: The y position at which an engine particle effect is drawn.</li>
	</ul>
	<p>In game maker it is considered a good habit to prefix every local variable with "_".</p>
	<p>Built-in variables: A special type of variable that are utilized by Game Maker to address certain functionalities, such a a default image rotation.
	<ul>
	<li>speed: Determines how many pixels an instance will be moved per frame. </li>
	<li>image_angle: Checks the angle of an image (clockwise) relative to the angle at which it was imported into the engine.</li>
	</ul>
	
	<p>Whew, that's a few variables, but do not worry as I intend to explain why I use these variables. If it is not in this post I will try to explain it at a later date in a seperate one.
	<hr>
	<h4>Moving the player</h4>
	<p>The player can move the ship by pressing the right mouse button. The player can change direction by dragging his mouse to the desired location.</p>
	<img class="img-fluid" width="100%" src="../images/blog1playermovement.png" alt="The player's movement code." />
	<p>First we create a new variable called _thrust to check if the right mouse button is pressed. In the next step we equal the image_index to _thrust. That seems odd? What happens here? The image index is a number starting at 0, images (often referred to as sprites) are stored in a sprite file. This sprite file can contain 1 image, 10 images, or a 100 images. This is used to animate a sprite which is exactly what we are doing here, except that we only have 2 images. If the variable _thrust is false, it equates to 0, so we grab the first image we can find, which is an image of the player's ship with the engine turned off. If the player is moving the _thrust variable will equal true which in turn equates to 1. So we grab the second image in the range which happens to be an image of the player's ship with an active engine/thruster.</p>
	<p>We also allocate a variable for the _angle_difference, but we don't use it yet. It equals the difference between the image's angle and the direction in which the mouse points relative to the player's ship. The angle difference is not used right away, we are going to need it in a moment!</p>
	<p>We can see two if statements, you may have concluded the behaviour for rotating the ship changes based on the player's speed. First we check if the player's speed is less than "hyperspeed", if it is we simply equal the angle of the image to the angle of the player's ship relative to the mouse. Note that I could have simply used an if else statement here, but for clarity I decided to use an if statement for both scenarios.</p>
	<p>	In the second if statement the speed has to be equal or greater than the "hyperspeed". If it is we don't want to alter the old angle to the new angle straight away, it would look very weird because the player's ship would change direction too abruptly. We use the min function which returns the smallest value in a set of real value arguments. The first parameter is the abs of the mouse direction, which is used to convert the angle to a real/absolute value. This means that if the value is positive it will remain the same, but if it is negative it will be multiplied by negative 1 to make it positive. Next we divide the rotation speed by 20. The default rotation speed equals 0.2. It is divided by 20 and equals 0.01. 20 was simply used for experimenting so you can easily alter the variable, if you are finished with testing, it is smarter to change the rotation_speed to the desired value (in my case 0.01) and remove divided by 20.</p>
	<p>	The result of the min function is multiplied with a sign function that takes the angle_difference as an argument. This function returns whether a number is positive, negative or neither and returns 1, -1, 0 respectively. For example - sign(180) will return 1, sign(-5) will return -1 and sign(0) will return 0. We know for a fact that our angle can never be greater than 360 degrees and it will always be positive. Lets see what this function returns for a single frame. Imagine our ship is flying towards the right, which is a rotation of 0 degrees because it is our imported image. We want to turn left, so the player drags his mouse to the left side of the player. This will give us a desired angle of 179 degrees (you will see why we dont use 180 shortly). Let's attempt to fill in the formula. image_angle -= min(abs(179), 0.01) * sign(angle_difference(0, 179)). image_angle -= 0.01  * 1 = 0.01. 0.01 is smaller than the angle in degrees (always converted to a positive value), thus min will return the rotation_speed (0.01). The difference in the angle is positive. The player's image angle would be adjusted by 0.01 every frame, let's say we have 60 frames a second. The player's angle would be modified by 60*0.01 = 0.6 degrees per second.  </p>
	<img class="img-fluid" width="50%" src="../images/point_direction.png" alt="The point direction function in Game Maker" />
	<p>An image of the point direction function.</p>
	<p>However, the rotation is completely different when it exceeds 180 degrees. You should always use the smallest angle so if the angle were 181 degrees rotation would be negative 179 degrees. This is the very reason we convert the value to a positive. This way we also rotate the player in the correct way. If the player needs to rotate 1 degree to the left (-1 degree) we don't want to rotate the player 359 degrees to the right! </p>
	<p>This results in smooth rotation when the player is flying very fast. You can also give nice feedback that the player has reaced the maximum speed by adding nice effects that follow the player's rotation.</p>
	<img class="img-fluid" width="50%" src="../images/spaceanim2.gif" alt="Smooth high-speed rotation." />
	<p>That's it for the rotation, now for moving the player... Grab a coffee, take a break and lets dive right in :)</p>
	<img class="img-fluid" width="50%" src="../images/blog1playermovementb.png" alt="The movement for the player" />
	<p>The movement code for the player.</p>
	<p>First we check if the player presses the right mouse button. If so, we are going to move the player's ship. If the speed is less than the hyperspeed divided by 2 the player can accelerate very fast. If the speed is equal or more than the hyperspeed divided by 2 the player can accelerate 3x less fast than normally. This means that he has to fly for a longer duration of time before reaching hyperspeed. This graph gives a rough idea of the player's speed from zero to reaching hyperspeed/2.</p>
	<img class="img-fluid" width="50%" src="../images/blog1acceltohyperspace.png" alt="The player's speed over time" />
	<p>The player's speed from the moment he starts moving to reaching hyperspeed/2. You can see that once the player reaches this point it will take relatively long to reach the maximum speed (because the acceleration is 3x less).</p>
	<p>For each frame that the player moves 2 particles are spawned. In the image of the movement code you can also see we use the _length variable (which is a local variable) to "travel" from the center of the sprite to the engine. Two engine particles are spawned in at the x and y position. We spawn the particle at our current x and y position,we use lengthdir to calculate the distance "len" pixels from the starting point in the direction dir. </p>
	<img class="img-fluid" width="50%" src="../images/lengthdir_image.png" alt="The lengthdir function" />
	<p>An image of the Lengthdir function.</p>
	<p>The lengthdir takes the _length, image_angle and offset as parameters. Let's say we have an image angle of 20 degrees and an offset of 2. With a position of 100, 100 the formula will result in _x = 100 + lengthdir_x(16, 20 + 2). We fill this in a grid, and we can find our point at 22 degrees upwards and 16 pixels in that direction. We can calculate it with 16 * cosine(22). This results in 16 * 0.92718385 = 14,835 (rounded up). We can find our new X location at 114,835. We can do the same for the lengthdir y, except that we need to use the negative sine. Sine is negative because Game Maker's position origin is not at the bottom left. It is at the top left, which means that the y value increases when you move downwards. When we calculate the new y position we will get: _y = 100 + lengthdir_y(16, 20+2). We can calculate it with 16 * -sine(22). This results in 16 * -0.37460659 =  5,99 (rounded up). We can find our new Y location at 105,99. In our scenario we use it to find the engine location of the player when his ship is rotated in a certain angle. We already know his current position and the angle so we can easily calculate where we should spawn the engine particles!</p>
	<p>When the player's ship is flying at hyperspeed you can see the position at which we spawn the engine particle is even less accurate. This is done because the player's ship will be flying quite fast and I wanted to make the engine particles spread out a bit more. You can also see instead of 2 particles per frame, 3 particles are spawned now. This is to make up for the increased speed. Your trail would otherwise look much less dense because the distance between each particle would be a lot greater.</p>
	<hr>
	<h4>Hyperspeed</h4>
	<p>You might be curious as to how the hyperspeed effect was created. It's actually quite simple!</p>
	<img class="img-fluid" width="50%" src="../images/hyperspeed2.png" alt="hyperspeed"/>
	<p>You can see a block of code in this image that instantiates the hyperspace particle.</p>
	<p>We create 2 instances of the hyperspeed object every two frames. We create those particles anywhere in the area that is visible to the player. In order for these particles to spawn, the speed has to be greater than or equal to the hyperspeed and the speed should also be greater than the previous speed. That means if the player is in hyperspace and decides to slow down, the particles will not be visible.</p>
	<p>If the speed is greater than or equal to 15 a much larger number of instances will be created. In the current state of the project this never happens because the player's maximum speed is a displacement of 9 per frame in any direction. However, it's fun to play around with for testing purposes!</p>
	<p>Now that we got spawning the particle out of the way, how does the particle work?</p>
	<p>The particle itself is a very small sprite of a few pixels in length and 1 pixel wide. Upon the creation of an instance of a hyperspeed particle, it's image_angle is immediately changed to match the angle of the player.</p>
	<p>As you can see in one of the gif files, the particles also fade-out. In order to achieve this the particles are instantiated with an opacity of 1, which is the inverse of transparency. So an opacity of 1 means it is not transparent at all. Every frame, the opacity is decreased by 0.01. This means that after a second (60 frames), the opacity will equal 0.4. This means that the complete image will be invisible as soon as the opacity equals 0. This will happen in exactly 100 frames. Every frame we check if the opacity is less than or equal to 0, if it is the instance is destroyed (we need to clean up the invisible particles or they will eat up memory).</p>
	<p>That's it for hyperspace!</p>
	<hr>
	<h4>Is this it?</h4>
	<p>For now, yes, but I have every intention of expanding this blog and posting more content. Are you interested in seeing a certain topic? Feel free to send me an email!</p>
	
	
	
	</div>
  
  
  
  
  
  
  
  <!-- Contact Section -->
  <div class="w3-container w3-padding-large w3-grey">
    <h4 id="contact"><b>Contact Me</b></h4>
    <div class="w3-row-padding w3-center w3-padding-24" style="margin:0 -16px">
      <div class="w3-third w3-dark-grey">
        <p><i class="fa fa-envelope w3-xxlarge w3-text-light-grey"></i></p>
        <p>vincent@pcs.nl</p>
      </div>
      <div class="w3-third w3-teal">
        <p><i class="fa fa-map-marker w3-xxlarge w3-text-light-grey"></i></p>
        <p>Zuid-Holland, The Netherlands</p>
      </div>
      <div class="w3-third w3-dark-grey">
        <p><i class="fa fa-phone w3-xxlarge w3-text-light-grey"></i></p>
        <p>0612079076</p>
      </div>
    </div>
    <hr class="w3-opacity">
	<!--WORK IN PROGRESS-->
	<!--
    <form action="/action_page.php" target="_blank">
      <div class="w3-section">
        <label>Name</label>
        <input class="w3-input w3-border" type="text" name="Name" required>
      </div>
      <div class="w3-section">
        <label>Email</label>
        <input class="w3-input w3-border" type="text" name="Email" required>
      </div>
      <div class="w3-section">
        <label>Message</label>
        <input class="w3-input w3-border" type="text" name="Message" required>
      </div>
      <button type="submit" class="w3-button w3-black w3-margin-bottom"><i class="fa fa-paper-plane w3-margin-right"></i>Send Message</button>
    </form>-->
  </div>



  <!-- Footer -->
  <footer class="w3-container w3-padding-32 w3-dark-grey">
  <div class="w3-row-padding">
  </div>
  </footer>
  
  <div class="w3-black w3-center w3-padding-24">Copyright Â© Vincent Hendriks 2020</div>

<!-- End page content -->
</div>

<script>
// Script to open and close sidebar
function w3_open() {
    document.getElementById("mySidebar").style.display = "block";
    document.getElementById("myOverlay").style.display = "block";
}
 
function w3_close() {
    document.getElementById("mySidebar").style.display = "none";
    document.getElementById("myOverlay").style.display = "none";
}

//script to add dynamic pagination
function page1_close() {
	document.getElementById("page1").style.display = "none";
}

function page2_close() {
	document.getElementById("page2").style.display = "none";
}

function page1_open() {
	document.getElementById("page1").style.display = "block";
}

function page2_open() {
	document.getElementById("page2").style.display = "block";
}
</script>


<script>
//Button styling -> active

// Get the container element
var btnContainer = document.getElementById("pagination");

// Get all buttons with class="btn" inside the container
var btns = btnContainer.getElementsByClassName("w3-bar-item");

// Loop through the buttons and add the active class to the current/clicked button
for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("active");
    current[0].className = current[0].className.replace(" active", "");
    this.className += " active";
  });
}


</script>

</body>
</html>